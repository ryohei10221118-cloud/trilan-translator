<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trilan Translator - 三語翻譯工具</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-left">
                    <h1>三語翻譯工具</h1>
                    <p>中文（繁體/簡體）· English · 한국어</p>
                </div>
                <div class="header-right">
                    <!-- 未登入狀態 -->
                    <div id="signInSection" class="auth-section">
                        <div class="login-form">
                            <input type="text" id="loginUsername" placeholder="帳號" class="login-input">
                            <input type="password" id="loginPassword" placeholder="密碼" class="login-input">
                            <button id="signInBtn" class="btn btn-light">
                                🔒 登入/註冊
                            </button>
                        </div>
                        <p class="auth-hint">新用戶首次登入將自動註冊 · 登入後可跨設備同步數據</p>
                    </div>

                    <!-- 已登入狀態 -->
                    <div id="userSection" class="auth-section" style="display: none;">
                        <div class="user-info">
                            <div class="user-details">
                                <strong id="userName">用戶</strong>
                                <small id="userEmail">email@example.com</small>
                            </div>
                            <div class="sync-status-container">
                                <span id="syncStatus" class="sync-status offline">未登入</span>
                            </div>
                        </div>
                        <div id="syncControls" class="sync-controls" style="display: none;">
                            <button id="uploadToCloudBtn" class="btn btn-sm btn-secondary" title="上傳本地數據到雲端">
                                ↑ 上傳
                            </button>
                            <button id="downloadFromCloudBtn" class="btn btn-sm btn-secondary" title="從雲端下載數據">
                                ↓ 下載
                            </button>
                            <button id="syncBtn" class="btn btn-sm btn-primary" title="手動同步">
                                ⟲ 同步
                            </button>
                            <button id="signOutBtn" class="btn btn-sm btn-danger">登出</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-button active" data-tab="translator">翻譯工具</button>
            <button class="tab-button" data-tab="dictionary">辭庫管理</button>
            <button class="tab-button" data-tab="phrase">句庫管理</button>
            <button class="tab-button" data-tab="category">分類管理</button>
        </div>

        <!-- 翻譯工具 Tab -->
        <div id="translatorTab" class="tab-content active">
            <div class="stats">
                <div class="stat-card">
                    <h3 id="dictCount">0</h3>
                    <p>辭庫詞條</p>
                </div>
                <div class="stat-card">
                    <h3 id="phraseCount">0</h3>
                    <p>句庫句子</p>
                </div>
                <div class="stat-card">
                    <h3 id="categoryCount">0</h3>
                    <p>分類數量</p>
                </div>
            </div>

            <!-- Claude API 配置 -->
            <div class="api-config">
                <h3>Claude API 設定</h3>

                <!-- API Key 未配置狀態 -->
                <div id="apiKeyInputSection" class="form-group">
                    <label for="claudeApiKey">Claude API Key</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="password" id="claudeApiKey" placeholder="輸入你的 Claude API Key (sk-ant-api03-...)">
                        <button id="saveApiKeyBtn" class="btn btn-primary">保存</button>
                        <button id="testApiKeyBtn" class="btn btn-secondary">測試</button>
                    </div>
                    <small style="color: #666; margin-top: 5px; display: block;">
                        API Key 將安全地保存在本地瀏覽器中。<a href="https://console.anthropic.com/settings/keys" target="_blank" style="color: #3b7dd6;">獲取 API Key</a>
                    </small>
                </div>

                <!-- API Key 已配置狀態 -->
                <div id="apiKeyConfiguredSection" style="display: none;">
                    <div style="padding: 15px; background: #e8f5e9; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong style="color: #2e7d32;">✓ API Key 已配置</strong>
                            <p style="margin: 5px 0 0 0; font-size: 0.9em; color: #666;">
                                <span id="apiKeyPreview">sk-ant-api03-****</span>
                            </p>
                        </div>
                        <button id="changeApiKeyBtn" class="btn btn-secondary">修改</button>
                    </div>
                </div>
            </div>

            <!-- AI 翻譯 -->
            <div class="ai-translation">
                <h3>AI 智能翻譯</h3>
                <div class="form-group">
                    <label for="translationInput">輸入文字（自動檢測語言）</label>
                    <textarea id="translationInput" placeholder="輸入中文、英文或韓文..." rows="3"></textarea>
                </div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <button id="translateBtn" class="btn btn-primary">🤖 AI 翻譯</button>
                </div>
                <div id="aiTranslationResult" class="translation-result" style="display: none;">
                    <!-- AI 翻譯結果將顯示在這裡 -->
                </div>
            </div>

            <!-- 辭庫/句庫搜索 -->
            <div class="dictionary-search">
                <h3>辭庫/句庫搜索</h3>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="輸入中文、英文或韓文進行搜索...">
                </div>
                <div class="translation-result" id="translationResults">
                    <!-- 搜索結果將顯示在這裡 -->
                </div>
            </div>

            <div style="margin-top: 30px; text-align: center;">
                <button id="exportBtn" class="btn btn-success">導出數據</button>
                <button id="importBtn" class="btn btn-primary">導入數據</button>
                <input type="file" id="importFile" accept=".json" style="display: none;">
            </div>
        </div>

        <!-- 辭庫管理 Tab -->
        <div id="dictionaryTab" class="tab-content">
            <h2>新增/編輯辭庫</h2>
            <form id="dictionaryForm">
                <div class="form-group">
                    <label for="dictTraditional">繁體中文</label>
                    <input type="text" id="dictTraditional">
                </div>
                <div class="form-group">
                    <label for="dictSimplified">简体中文 *</label>
                    <input type="text" id="dictSimplified" required>
                </div>
                <div class="form-group">
                    <label for="dictEnglish">English *</label>
                    <input type="text" id="dictEnglish" required>
                </div>
                <div class="form-group">
                    <label for="dictKorean">한국어 *</label>
                    <input type="text" id="dictKorean" required>
                </div>
                <div class="form-group">
                    <label for="dictCategory">分類</label>
                    <select id="dictCategory">
                        <option value="">請選擇分類</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">保存</button>
            </form>

            <h2 style="margin-top: 40px;">辭庫列表</h2>
            <table>
                <thead>
                    <tr>
                        <th>繁體中文</th>
                        <th>简体中文</th>
                        <th>English</th>
                        <th>한국어</th>
                        <th>分類</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="dictionaryList">
                    <!-- 辭庫列表將顯示在這裡 -->
                </tbody>
            </table>
        </div>

        <!-- 句庫管理 Tab -->
        <div id="phraseTab" class="tab-content">
            <h2>新增/編輯句庫</h2>
            <form id="phraseForm">
                <div class="form-group">
                    <label for="phraseTraditional">繁體中文</label>
                    <textarea id="phraseTraditional"></textarea>
                </div>
                <div class="form-group">
                    <label for="phraseSimplified">简体中文 *</label>
                    <textarea id="phraseSimplified" required></textarea>
                </div>
                <div class="form-group">
                    <label for="phraseEnglish">English *</label>
                    <textarea id="phraseEnglish" required></textarea>
                </div>
                <div class="form-group">
                    <label for="phraseKorean">한국어 *</label>
                    <textarea id="phraseKorean" required></textarea>
                </div>
                <div class="form-group">
                    <label for="phraseCategory">分類</label>
                    <select id="phraseCategory">
                        <option value="">請選擇分類</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">保存</button>
            </form>

            <h2 style="margin-top: 40px;">句庫列表</h2>
            <table>
                <thead>
                    <tr>
                        <th>繁體中文</th>
                        <th>简体中文</th>
                        <th>English</th>
                        <th>한국어</th>
                        <th>分類</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="phraseList">
                    <!-- 句庫列表將顯示在這裡 -->
                </tbody>
            </table>
        </div>

        <!-- 分類管理 Tab -->
        <div id="categoryTab" class="tab-content">
            <h2>新增/編輯分類</h2>
            <form id="categoryForm">
                <div class="form-group">
                    <label for="categoryName">分類名稱 *</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group">
                    <label for="categoryType">分類類型 *</label>
                    <select id="categoryType" required>
                        <option value="">請選擇類型</option>
                        <option value="dictionary">辭庫分類</option>
                        <option value="phrase">句庫分類</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">保存</button>
            </form>

            <h2 style="margin-top: 40px;">分類列表</h2>
            <table>
                <thead>
                    <tr>
                        <th>分類名稱</th>
                        <th>類型</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="categoryList">
                    <!-- 分類列表將顯示在這裡 -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Firebase Configuration (將 firebase-config.template.js 複製為 firebase-config.js 並填入配置) -->
    <script src="firebase-config.js"></script>

    <!-- Application Scripts -->
    <script src="js/translator.js"></script>
    <script src="js/firebase.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
